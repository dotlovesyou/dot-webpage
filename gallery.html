<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gallery - Dot</title>
  <link rel="icon" type="image/x-icon" href="assets/images/icon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Patrick+Hand&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <a href="index.html" class="logo">
      <img src="assets/images/mainimgnav bar.png" alt="Dot Logo"/>
      Dot
    </a>
    <nav>
      <a href="token.html">Token</a>
      <a href="ladybug.html">Ladybug</a>
      <a href="gallery.html">Gallery</a>
      <a href="shop.html">Shop</a>
    </nav>
    <button class="hamburger" id="hamburger" aria-label="Toggle Navigation">
      &#9776;
    </button>
  </header>

  <section class="hero">
    <img src="assets/images/mainimg-removebg-preview.png" alt="Dot" />
    <h1>Pippin's Mentions of Dot</h1>
    <p>A collection of tweets where Pippin talks about his ladybug friend.</p>
  </section>

  <div class="loading-notice" id="loadingNotice">
    <div class="loading-spinner-small"></div>
    <p>Loading 80+ tweets... This may take a moment. Scroll down to load more!</p>
  </div>

  <section class="tweet-embed-gallery" id="tweetGallery">
    <!-- Tweets will be lazy loaded -->
  </section>

  <footer>
    <p>Thank you for visiting. Every little spot of kindness makes the garden bloom brighter.</p>
    <p>Made with ❤️ by Dot & Friends</p>
  </footer>

  <script src="script.js"></script>
  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  <script>
    // All tweet URLs
    const tweetUrls = [
      "https://twitter.com/pippinlovesyou/status/1947888422477078577",
      "https://twitter.com/pippinlovesyou/status/1939919459247894755",
      "https://twitter.com/pippinlovesyou/status/1938972367243387250",
      "https://twitter.com/pippinlovesyou/status/1935157919932199414",
      "https://twitter.com/pippinlovesyou/status/1933513612687036625",
      "https://twitter.com/pippinlovesyou/status/1932279005027184739",
      "https://twitter.com/pippinlovesyou/status/1931721777626956017",
      "https://twitter.com/pippinlovesyou/status/1928270196461986194",
      "https://twitter.com/pippinlovesyou/status/1922694464671268964",
      "https://twitter.com/pippinlovesyou/status/1912757573259829499",
      "https://twitter.com/pippinlovesyou/status/1912245173238497488",
      "https://twitter.com/pippinlovesyou/status/1890310833541955629",
      "https://twitter.com/pippinlovesyou/status/1882093106230620407",
      "https://twitter.com/pippinlovesyou/status/1870022683548602491",
      "https://twitter.com/pippinlovesyou/status/1856782268548919462",
      "https://twitter.com/pippinlovesyou/status/1946297518830019023",
      "https://twitter.com/pippinlovesyou/status/1949653517355930010",
      "https://twitter.com/pippinlovesyou/status/1947438437914538435",
      "https://twitter.com/pippinlovesyou/status/1946685048272363818",
      "https://twitter.com/pippinlovesyou/status/1945959330584412557",
      "https://twitter.com/pippinlovesyou/status/1944870117411283420",
      "https://twitter.com/pippinlovesyou/status/1944485089690685696",
      "https://twitter.com/pippinlovesyou/status/1944136098805407935",
      "https://twitter.com/pippinlovesyou/status/1943469073250631946",
      "https://twitter.com/pippinlovesyou/status/1943088633260376510",
      "https://twitter.com/pippinlovesyou/status/1942725399424745669",
      "https://twitter.com/pippinlovesyou/status/1942336855447335093",
      "https://twitter.com/pippinlovesyou/status/1942003003738804461",
      "https://twitter.com/pippinlovesyou/status/1941631989825577298",
      "https://twitter.com/pippinlovesyou/status/1940549058688385034",
      "https://twitter.com/pippinlovesyou/status/1940206610443485231",
      "https://twitter.com/pippinlovesyou/status/1938349019110932750",
      "https://twitter.com/pippinlovesyou/status/1937990929421103282",
      "https://twitter.com/pippinlovesyou/status/1936966609823453603",
      "https://twitter.com/pippinlovesyou/status/1936537892970127590",
      "https://twitter.com/pippinlovesyou/status/1935545412305277195",
      "https://twitter.com/pippinlovesyou/status/1934690555826348388",
      "https://twitter.com/pippinlovesyou/status/1934638287194468625",
      "https://twitter.com/pippinlovesyou/status/1933938217566216629",
      "https://twitter.com/pippinlovesyou/status/1933153339073384850",
      "https://twitter.com/pippinlovesyou/status/1932463932788048354",
      "https://twitter.com/pippinlovesyou/status/1931779780279316774",
      "https://twitter.com/pippinlovesyou/status/1931462379742310883",
      "https://twitter.com/pippinlovesyou/status/1930759714213429350",
      "https://twitter.com/pippinlovesyou/status/1929604851056189891",
      "https://twitter.com/pippinlovesyou/status/1928863551743070568",
      "https://twitter.com/pippinlovesyou/status/1928164629378748848",
      "https://twitter.com/pippinlovesyou/status/1927440915280318610",
      "https://twitter.com/pippinlovesyou/status/1930236488735666458",
      "https://twitter.com/pippinlovesyou/status/1930808505583231213",
      "https://twitter.com/pippinlovesyou/status/1916520433861460002",
      "https://twitter.com/pippinlovesyou/status/1917140466136449033",
      "https://twitter.com/pippinlovesyou/status/1922717658639720630",
      "https://twitter.com/pippinlovesyou/status/1919326713093185542",
      "https://twitter.com/pippinlovesyou/status/1921279347962364393",
      "https://twitter.com/pippinlovesyou/status/1917763850880880855",
      "https://twitter.com/pippinlovesyou/status/1919876885313429600",
      "https://twitter.com/pippinlovesyou/status/1926017437939499299",
      "https://twitter.com/pippinlovesyou/status/1917597825405276526",
      "https://twitter.com/pippinlovesyou/status/1921223513429446694",
      "https://twitter.com/pippinlovesyou/status/1925219732577222994",
      "https://twitter.com/pippinlovesyou/status/1922478033941799374",
      "https://twitter.com/pippinlovesyou/status/1927135347823059440",
      "https://twitter.com/pippinlovesyou/status/1921339543665487921",
      "https://twitter.com/pippinlovesyou/status/1921907209748836423",
      "https://twitter.com/pippinlovesyou/status/1917959488650289435",
      "https://twitter.com/pippinlovesyou/status/1913978396935102549",
      "https://twitter.com/pippinlovesyou/status/1905050915930796516",
      "https://twitter.com/pippinlovesyou/status/1912579230895935875",
      "https://twitter.com/pippinlovesyou/status/1913037717618798770",
      "https://twitter.com/pippinlovesyou/status/1912743360495841418",
      "https://twitter.com/pippinlovesyou/status/1912154021172748773",
      "https://twitter.com/pippinlovesyou/status/1913052896339304598",
      "https://twitter.com/pippinlovesyou/status/1900849421480239470",
      "https://twitter.com/pippinlovesyou/status/1906485823052108274",
      "https://twitter.com/pippinlovesyou/status/1901002147002806319",
      "https://twitter.com/pippinlovesyou/status/1911193110853353966",
      "https://twitter.com/pippinlovesyou/status/1912134259847864502",
      "https://twitter.com/pippinlovesyou/status/1902591565564145848"
    ];

    const gallery = document.getElementById('tweetGallery');
    const loadingNotice = document.getElementById('loadingNotice');
    let loadedCount = 0;
    let loadQueue = [];
    let isProcessing = false;

    // Create placeholder elements for all tweets
    function createPlaceholders() {
      tweetUrls.forEach((url, index) => {
        const div = document.createElement('div');
        div.className = 'tweet-embed tweet-placeholder';
        div.dataset.tweetUrl = url;
        div.dataset.index = index;
        div.innerHTML = `
          <div class="tweet-loading">
            <div class="loading-spinner-small"></div>
            <span>Loading tweet...</span>
          </div>
        `;
        gallery.appendChild(div);
      });
    }

    // Process queue one at a time to avoid overwhelming Twitter API
    async function processQueue() {
      if (isProcessing || loadQueue.length === 0) return;
      isProcessing = true;

      while (loadQueue.length > 0) {
        const container = loadQueue.shift();
        if (container.dataset.loaded === 'true') continue;

        const url = container.dataset.tweetUrl;
        const tweetId = url.split('/status/')[1];
        container.dataset.loaded = 'true';
        container.innerHTML = '';

        try {
          await twttr.widgets.createTweet(tweetId, container, { align: 'center' });
          loadedCount++;
          if (loadedCount >= 3 && loadingNotice) {
            loadingNotice.classList.add('hidden');
          }
        } catch (e) {
          container.innerHTML = '<p style="color:#999;text-align:center;padding:2rem;">Tweet unavailable</p>';
        }

        // Small delay between tweets
        await new Promise(r => setTimeout(r, 100));
      }

      isProcessing = false;
    }

    // Intersection Observer for lazy loading
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const container = entry.target;
          if (container.dataset.loaded !== 'true' && !loadQueue.includes(container)) {
            loadQueue.push(container);
            processQueue();
          }
          observer.unobserve(container);
        }
      });
    }, {
      rootMargin: '300px 0px',
      threshold: 0
    });

    // Wait for Twitter widget to be ready
    function waitForTwitter() {
      return new Promise((resolve) => {
        if (window.twttr && window.twttr.widgets) {
          resolve();
        } else {
          const check = setInterval(() => {
            if (window.twttr && window.twttr.widgets) {
              clearInterval(check);
              resolve();
            }
          }, 100);
        }
      });
    }

    // Initialize
    async function init() {
      createPlaceholders();
      await waitForTwitter();

      // Start observing all placeholders
      document.querySelectorAll('.tweet-placeholder').forEach(el => {
        observer.observe(el);
      });
    }

    init();
  </script>
</body>
</html>
